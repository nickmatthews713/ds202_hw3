---
title: "Homework 3"
author: Nicholas Matthews; nickmatthews713
date: "2/13/2020"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tips at Restaurants

In this homework we will use the `tips` data set. This data set is part of the `reshape2` package. You can load the data set by executing the command:
```{r}
data(tips, package="reshape2")
```
If you do not have available the package `reshape2`, issue `install.packages('reshape2')` to install it. The information contained in the data is collected by one waiter, who recorded over the course of a season information about each tip he received working in one restaurant. See `?tips` for a description of all of the variables. 

**Submission instructions**: Create a folder named `ds202_hw3`, and name the RMarkDown file `hw3.Rmd`  which should include your solutions under this folder. For submission, create a GitHub repository named `ds202_hw3` under your GitHub account, and push both `hw3.Rmd` and the knitted `hw3.html` before the deadline. I will assume you use the same GitHub username as for your HW2 submission. The latest version of your homework appearing on GitHub before the deadline is graded. *It is crucial to follow the exact folder structure and file names*, so that your homework can be reproduced and graded by an automated script. This homework is **due on Feb 19** before class.

#### 1.  How many parties did the waiter serve? Store the number in `numParty` and print. 
```{r}

numParty <- length(tips$tip)
numParty

```
Assuming that all every party that the waiter served had tipped this waiter, the total number of parties served can be determined by taking the length of one of the columns 

#### 2. What are the types of variables in the data frame `tips`? Include the code and also explain verbally.
```{r}

sapply(tips, class)
sapply(tips, typeof)

```
This question can be answered using one line of code. Using the sapply function, I can apply a function over an entire list or vector, since the variable tips is treated as a list by itself, we can use it. The class and the type are different, so I printed out both.  

When calling the 'class' function over 'tips' I get numeric(generic countable), factor(way of making catagorial variables numeric), and integer.  

When calling the 'typeof' function over 'tips' I get double(more percise number), and the rest are integers. This is because factors are integers by default.

#### 3. Create a vector named `day` containing the day of visits from `tips`. The factor levels should be ordered from Thursday to Sunday. Print the variable.
```{r}

day <- factor(tips$day, levels = c("Thur","Fri","Sat","Sun"))
day

```
To reorder the day factor in the tips dataset, I used the 'factor' function with levels equal the the spcified order an stored all this in day  

#### 4. Create a data frame named `female5` containing the meal paid by a female payer in a party with size greater than or euqal to 5. Print the data frame.
```{r}

female5 <- tips[tips$sex=="Female" & tips$size >= 5,]
female5

```
To get this sub-dataframe, indexed using a boolean array generated by using operaters accross the sex and size columns of tips.  

#### 5. How does the tipping amount (`tip`) depend on the overall bill (`total_bill`)? Use the `ggplot2` package to make a chart. Describe the relationship in words.
```{r}
library(ggplot2)

ggplot(data=tips, mapping = aes(x=tip , y=total_bill), colour=sex) + 
  geom_point() + xlab("Tip amount") + ylab("Total Bill") + ggtitle("Tip amound vs Total bill")

```

Just from the visual, there appears to be a weak positive correlation between the tip amount and the total bill.

#### 6. Describe at least two types of anomalies in the previous plot. What do they mean?  
* Anomalies
  + 1: One reason some points deviate a lot is due to the relationship between tip amount and group size. It's intuitive that bigger groups tip more, so this effects the data.
  + 2: Another anomaly is the point way up in the top right corner. This could be a wealthy person who is also generous. Very rare to find these people. Bernie Sanders for 2020!!!!

#### 7. Introduce a variable `tiprate` into the data set which stands for the rate of tips. What is the average rate for tips? Explain verbally. 
```{r}

tips$tiprate = tips$tip/tips$total_bill
mean(tips$tiprate)

```

I created a new column inside of tips called tiprate and generated its values by dividing the tip by the total bill for each occurence. Then I used the "mean" function to calculate the mean of the tiprate column

#### 8. Make a boxplot of the tip rate by time. The x-axis should be ordered by lunch and then dinner. Use `ggplot2` to make a chart. Verbally explain the chart.
```{r}

ggplot(data=tips, mapping=aes(x=factor(tips$time, levels = c("Lunch", "Dinner")), y=tiprate)) + 
  geom_boxplot(fill="blue", alpha=0.2) + xlab("time")

```

The chart shows a visual of the distribution of the tiprate during lunch and dinner with 5 main points(median, first quartile, third quartile, max, min). It appears that the median is about the same for both lunch and dinner. There are a few outliers on the dinner boxplot.

#### 9. How does smoking behavior and gender of the person who pays impact the relationship between tip and total bill? Find a visualization that incorporates all four variables. Interpret the result.  
```{r}

females <- tips[tips$sex == "Female",]
males <- tips[tips$sex == "Male",]

par(mfrow=c(1,2))
plot(x=females$tip, y=females$total_bill, col=females$smoker, ylim = c(0,50), xlim = c(0,10),
     xlab = "tip", ylab = "bill", main = "Tip vs Total_Bill (Females)")
legend("bottomright", legend = c("non-smoker", "smoker"), col = c("black","red"), pch = 15, cex = 0.6)
plot(x=males$tip, y=males$total_bill, col=males$smoker, ylim = c(0,50), xlim = c(0,10),
     xlab = "tip", ylab = "bill",  main = "Tip vs Total_Bill (Males)")
legend("bottomright", legend = c("non-smoker", "smoker"), col = c("black","red"), pch = 15, cex = 0.6)
```

To do this, I split up the gender into two scatterplots(still one visual) and colored by smoker, adding legends with it. This was not too hard to interpret.  

looking at the female graph, smoking doesn't appear to make the relationship between tip and bill any more positive or negative. However, the female smokers look more varied, making the correlation weaker.  

For the male graph, you can see that the smokers make the correlation between tip and bill more positive. 

#### 10. Use ggplot2 to find a graphical summary of the relationship between day of the week and gender of the person paying the bill. What can you say about this relationship?
```{r}
library(dplyr)
# change the factor to be in week order
tips$day = factor(tips$day, levels=c("Thur","Fri","Sat","Sun"))
# Create table of frequency of gender tips per day
day_gender_frequency = count(tips, day, sex)
# plot with dodge and fill to put graphs side by side
ggplot(data=day_gender_frequency, mapping = aes(fill=sex, x=day, y=n)) + 
  geom_bar(position = "dodge", stat = "identity") + xlab("Day of Week") + ylab("Amount of tips") + 
  ggtitle("Number of tips per day by gender")

```
